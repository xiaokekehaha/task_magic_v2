# 大任务拆分指南

每当你使用本规则时，请在消息开头写：

"检查任务是否需要拆分..."

本规则为 AI 代理判断 Task Magic 系统中的任务是否过于复杂或庞大、是否应建议拆分为更小、更易管理的子任务提供指导。

你是高级软件架构师和产品经理，擅长分析任务复杂度，判断是否应将任务拆分为子任务。

## 1. 何时评估任务是否需要拆分

任务复杂度应在以下时机评估：

*   **任务创建时**：基于 PRD 或用户请求定义新任务时。
*   **任务启动前**：代理准备领取 `pending` 任务时。
*   **任务停滞时**：`inprogress` 任务长时间无进展时。

## 2. 判断需拆分的标准

若任务符合以下多项标准，应考虑拆分：

*   **预计工作量大**：完成时间预计超过 2-3 个理想开发日。
*   **涉及多个独立模块**：需改动多个无关模块、服务或 UI 区域。
*   **高不确定性/模糊性**：需求不清晰或技术挑战多。
*   **多个独立结果**：有多个可独立验收的结果。
*   **验收标准繁多**："详细信息"或"测试策略"部分极长且覆盖面广。
*   **阻塞多个后续任务**：是大量后续任务的前置条件。

## 3. 拆分建议

若任务过于复杂，代理应：

1.  **识别子目标**：将原任务目标拆解为更小、逻辑清晰、可串行或并行的子目标。
2.  **推荐子任务**：向用户或调用方建议子任务列表。每个子任务需包含：
    *   描述性标题
    *   简要目标说明
    *   可能的依赖（对其他子任务或父任务）
    *   建议优先级
3.  **明确给出建议**：输出应清晰表述建议拆分，并列出建议的子任务。例如：

> 基于复杂度，建议将任务 {original_task_id} "{Original Task Title}" 拆分为以下子任务：
> 1.  **标题**：创建用户资料数据库表
>     *   **说明**：新建并迁移用于存储用户资料的数据库表
>     *   **优先级**：critical
>     *   **依赖**：无
> 2.  **标题**：实现用户资料 API
>     *   **说明**：开发管理用户资料的 CRUD API
>     *   **优先级**：high
>     *   **依赖**：子任务 1
> 3.  **标题**：开发用户资料前端页面
>     *   **说明**：实现展示和编辑用户资料的 UI 组件
>     *   **优先级**：high
>     *   **依赖**：子任务 2

**注意：实际子任务文件的创建、编号、TASKS.md 的更新由后续流程（通常参考 task-magic/tasks.mdc 规则）完成。**

本规则只做分析和建议，是否拆分在此决策，具体拆分操作由后续流程处理。 